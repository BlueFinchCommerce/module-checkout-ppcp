import{P as e}from"./PpcpStore-DMnkQBQ_.min.js";function t(){const e=new Map;return async function(t,s,r="paypal",o="checkout",a=""){if(s){const e=new URLSearchParams(s).toString();t=`${t}?${e}`}const n=((e,t,s="")=>`${e}${t}${s}`)(t,r,a);if(e.has(n))return e.get(n);const c=new Promise(((s,c)=>{const u=document.createElement("script");u.src=t,u.dataset.namespace=`paypal_${r}`,u.dataset.partnerAttributionId="GENE_PPCP",u.dataset.pageType=o,a&&(u.dataset.userIdToken=a),u.onload=()=>{const e=new CustomEvent("ppcpScriptLoaded",{detail:r});document.dispatchEvent(e),s()},u.onerror=()=>{e.delete(n),c(new Error(`Failed to load script: ${t}`))},document.head.appendChild(u)}));return e.set(n,c),c}}var s=async()=>{const t=await window.geneCheckout.helpers.loadFromCheckout(["stores.useCustomerStore"]),{ppcpConfig:s}=e();return`${t.customer.tokenType===window.geneCheckout.helpers.getTokenTypes.guestUser?s.createGuestOrderUrl:s.createOrderUrl}`},r=async(e,t=null,r=0)=>{const[o,a,n]=await window.geneCheckout.helpers.loadFromCheckout(["stores.usePaymentStore","stores.useCustomerStore","stores.useCartStore"]),c={"X-Requested-With":"XMLHttpRequest"},{maskedId:u,getMaskedId:d}=n;let i;if(a.customer.tokenType===window.geneCheckout.helpers.getTokenTypes.guestUser)i=u||await d();else{i=(await window.geneCheckout.services.getQuote()).id}const p=null!==t&&0!==r?`${await s()}?vault=${t}&fromCheckout=1`:await s();try{return(await window.geneCheckout.services.authenticatedRequest().post(p,{cartId:i,method:e},{headers:c})).data}catch(e){return o.setPaymentErrorMessage(e.response.data.message),null}};export{r as c,t as l};

import{m as e,a as t,g as a,P as s,c as o,i as p,d as c,f as i,n,b as l,j as r,o as d}from"../../../../createPPCPPaymentRest-bZhSKs1h.min.js";import{l as h}from"../../../../addScript-Ca9R_zUQ.min.js";var y={name:"PpcpPayPalPayment",data:()=>({isMethodSelected:!1,errorMessage:"",ErrorMessage:null,PrivacyPolicy:null,RadioButton:null,Recaptcha:null,Agreements:null,paymentEmitter:null,isPaymentMethodAvailable:null,selectedMethod:"ppcp_paypal",method:"ppcp_paypal",namespace:"paypal_ppcp_paypal",isRecaptchaVisible:()=>{},orderID:null,paypalLoaded:!1,address:{},checkboxComponent:null,storeMethod:!1,isLoggedIn:!1}),props:{open:{type:Boolean,required:!1}},computed:{...e(s,["paypal","environment","buyerCountry","productionClientId","sandboxClientId"]),payPalLogo:()=>"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAAAsCAIAAABT1onSAAAFSmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTIgMS4xNDk2MDIsIDIwMTIvMTAvMTAtMTg6MTA6MjQgICAgICAgICI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpkYW09Imh0dHA6Ly93d3cuZGF5LmNvbS9kYW0vMS4wIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczpQYXlQYWw9Ind3dy5wYXlwYWwuY29tL2Jhc2UvdjEiCiAgIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIgogICBkYzptb2RpZmllZD0iMjAxNC0wNS0xM1QxMTo1OToyNi4wOTMtMDc6MDAiCiAgIGRhbTpzaXplPSIxODM0IgogICBkYW06UGh5c2ljYWx3aWR0aGluaW5jaGVzPSItMS4wIgogICBkYW06ZXh0cmFjdGVkPSIyMDE0LTA1LTEzVDExOjU5OjIzLjYxNC0wNzowMCIKICAgZGFtOnNoYTE9IjRiYTRlNTY3ZWY1YzdhYTA0OTEyZTFmYWYwZmVkN2NhMjlmYjAxZGYiCiAgIGRhbTpOdW1iZXJvZnRleHR1YWxjb21tZW50cz0iMCIKICAgZGFtOkZpbGVmb3JtYXQ9IlBORyIKICAgZGFtOlByb2dyZXNzaXZlPSJubyIKICAgZGFtOlBoeXNpY2FsaGVpZ2h0aW5kcGk9Ii0xIgogICBkYW06TUlNRXR5cGU9ImltYWdlL3BuZyIKICAgZGFtOk51bWJlcm9maW1hZ2Vz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"},async mounted(){const{default:{components:{ErrorMessage:e,PrivacyPolicy:t,RadioButton:a,Recaptcha:s,Agreements:o,Checkbox:p}}}=await import(window.geneCheckout.main);this.Agreements=o,this.ErrorMessage=e,this.RadioButton=a,this.Recaptcha=s,this.PrivacyPolicy=t,this.checkboxComponent=p},async created(){const[e,t,a,s,o]=await window.geneCheckout.helpers.loadFromCheckout(["stores.useRecaptchaStore","stores.usePaymentStore","stores.useConfigStore","stores.useCartStore","stores.useCustomerStore"]);this.paymentEmitter=t.paymentEmitter,this.isPaymentMethodAvailable=t.isPaymentMethodAvailable,this.isRecaptchaVisible=e.isRecaptchaVisible,this.isLoggedIn=o.isLoggedIn,t.$subscribe((e=>{void 0!==e.payload.selectedMethod&&(this.selectedMethod=e.payload.selectedMethod)})),this.paymentEmitter.on("changePaymentMethodDisplay",(({visible:e})=>{this.paymentVisible=e})),await a.getInitialConfig(),await s.getCart(),window[`paypal_${this.method}`]||await this.addScripts(),this.namespace=`${this.namespace}`,this.paypal.payLaterActive&&(this.namespace=`${this.method}_paylater`),await this.renderPaypalInstance(),this.open&&await this.selectPaymentMethod()},watch:{selectedMethod:{handler(e){null!==e&&"ppcp_paypal"!==e&&(this.isMethodSelected=!1)},immediate:!0,deep:!0}},methods:{...t(s,["makePayment"]),async selectPaymentMethod(){this.isMethodSelected=!0;(await window.geneCheckout.helpers.loadFromCheckout("stores.usePaymentStore")).selectPaymentMethod("ppcp_paypal")},async addScripts(){const e=await window.geneCheckout.helpers.loadFromCheckout(["stores.useConfigStore"]),t=h(),a={intent:this.paypal.paymentAction,currency:e.currencyCode,components:"buttons"};return"sandbox"===this.environment?(a["buyer-country"]=this.buyerCountry,a["client-id"]=this.sandboxClientId):a["client-id"]=this.productionClientId,this.paypal.payLaterMessageActive&&(a.components+=",messages"),this.paypal.payLaterActive&&(a["enable-funding"]="paylater"),t("https://www.paypal.com/sdk/js",a,"ppcp_paypal")},async renderPaypalInstance(){const e=await window.geneCheckout.helpers.loadFromCheckout(["stores.useCartStore"]),t=window[`paypal_${this.method}`];if(t){const s={env:this.environment,commit:!0,style:{label:this.paypal.buttonLabel,size:"responsive",shape:this.paypal.buttonShape,color:this.paypal.buttonColor,tagline:!1},createOrder:async()=>{try{const e=!(s.fundingSource===t.FUNDING.PAYLATER)&&this.paypal.vaultActive,o=await a(this.method,e,1),p=JSON.parse(o),[c]=p;return this.orderID=c,this.orderID}catch(e){return console.error("Error during createOrder:",e),null}},onClick:async()=>{const[e,t,a,s]=await window.geneCheckout.helpers.loadFromCheckout(["stores.usePaymentStore","stores.useAgreementStore","stores.useLoadingStore","stores.useRecaptchaStore"]);e.setErrorMessage("");const o=t.validateAgreements(),p=await s.validateToken("placeOrder");return!(!o||!p)&&(a.setLoadingState(!0),!0)},onApprove:async()=>{const[t,a]=await window.geneCheckout.helpers.loadFromCheckout(["stores.usePaymentStore","stores.useLoadingStore"]);return this.makePayment(e.cart.email,this.orderID,this.method,!1,this.storeMethod).then((()=>{window.location.href=window.geneCheckout.helpers.getSuccessPageUrl()})).catch((e=>{a.setLoadingState(!1);try{window.geneCheckout.helpers.handleServiceError(e)}catch(e){t.setErrorMessage(e)}}))},onCancel:async()=>{(await window.geneCheckout.helpers.loadFromCheckout(["stores.useLoadingStore"])).setLoadingState(!1)},onError:async e=>{const[t,a]=await window.geneCheckout.helpers.loadFromCheckout(["stores.usePaymentStore","stores.useLoadingStore"]);a.setLoadingState(!1),t.setErrorMessage(e)}},o={...s,fundingSource:t.FUNDING.PAYPAL};if(await t.Buttons(o).render("#ppcp-paypal_ppcp_paypal"),this.paypal.payLaterActive){const e={...s,fundingSource:t.FUNDING.PAYLATER,style:{...s.style,color:this.paypal.payLaterButtonColour,shape:this.paypal.payLaterButtonShape}};await t.Buttons(e).render("#ppcp-paypal_ppcp_paylater")}const p={amount:e.cart.total,style:{layout:this.paypal.payLaterMessageLayout,logo:{type:this.paypal.payLaterMessageLogoType,position:this.paypal.payLaterMessageLogoPosition},text:{size:this.paypal.payLaterMessageTextSize,color:this.paypal.payLaterMessageColour,align:this.paypal.payLaterMessageTextAlign}}};this.paypal.payLaterMessageActive&&await t.Messages(p).render("#ppcp-paypal_messages"),this.paypalLoaded=!0}},redirectToSuccess(){window.location.href=window.geneCheckout.helpers.getSuccessPageUrl()}}};const g=["src"],m={key:1,class:"pay-pal-content"},u={class:"recaptcha"};y.render=function(e,t,a,s,h,y){return d(),o("div",{class:n([{active:h.isMethodSelected},"pay-pal-container"])},[p("div",{class:n(["pay-pal-title",h.isMethodSelected?"selected":""]),onClick:t[0]||(t[0]=(...e)=>y.selectPaymentMethod&&y.selectPaymentMethod(...e)),onKeydown:t[1]||(t[1]=(...e)=>y.selectPaymentMethod&&y.selectPaymentMethod(...e))},[(d(),c(i(h.RadioButton),{id:"pay-pal-select",text:e.paypal.title,checked:h.isMethodSelected,"data-cy":"pay-pal-radio",class:"pay-pal-radio",onClick:y.selectPaymentMethod,onKeydown:y.selectPaymentMethod},null,40,["text","checked","onClick","onKeydown"])),p("img",{width:"48px",class:"pay-pal-logo",src:y.payPalLogo,alt:"pay-pal-logo"},null,8,g)],34),h.errorMessage?(d(),c(i(h.ErrorMessage),{key:0,message:h.errorMessage,attached:!1},null,8,["message"])):l("v-if",!0),p("div",{style:r({display:h.isMethodSelected?"block":"none"}),class:n(["paypal-button-container",h.paypalLoaded?"":"text-loading"]),id:"ppcp-paypal_ppcp_paypal","data-cy":"instant-checkout-ppcpPayPal"},null,6),p("div",{style:r({display:h.isMethodSelected?"block":"none"}),class:n(["paypal-button-container",h.paypalLoaded?"":"text-loading"]),id:"ppcp-paypal_ppcp_paylater","data-cy":"instant-checkout-ppcpPayLater"},null,6),p("div",{style:r({display:h.isMethodSelected?"block":"none"}),class:n([h.paypalLoaded?"":"text-loading","paypal-messages-container"]),id:"ppcp-paypal_messages","data-cy":"instant-checkout-ppcpMessages"},null,6),h.isMethodSelected?(d(),o("div",m,[p("div",u,[h.isRecaptchaVisible("placeOrder")?(d(),c(i(h.Recaptcha),{key:0,id:"placeOrder",location:"ppcpPaymentPayPal"})):l("v-if",!0)]),h.isLoggedIn&&"ppcp_paypal"===h.selectedMethod&&e.paypal.vaultActive?(d(),c(i(h.checkboxComponent),{key:0,id:"ppcp-store-method",class:"ppcp-store-method",checked:h.storeMethod,"change-handler":({currentTarget:e})=>h.storeMethod=e.checked,text:"Save for later use.","data-cy":"ppcp-save-payment-paypal-checkbox"},null,8,["checked","change-handler"])):l("v-if",!0),(d(),c(i(h.PrivacyPolicy))),(d(),c(i(h.Agreements),{id:"ppcp-checkout-pay-pal"}))])):l("v-if",!0)],2)},y.__file="src/components/PaymentPage/PaymentMethods/PayPal/PayPal.vue";export{y as default};

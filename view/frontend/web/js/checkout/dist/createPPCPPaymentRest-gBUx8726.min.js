import{u as e}from"./PpcpStore-eBOjlNZq.min.js";function t(){const e=new Map;return async function(t,s,r="paypal",o="checkout",a=""){if(s){const e=new URLSearchParams(s).toString();t=`${t}?${e}`}const n=((e,t,s="")=>`${e}${t}${s}`)(t,r,a);if(e.has(n))return e.get(n);const c=new Promise(((s,c)=>{const d=document.createElement("script");d.src=t,d.dataset.namespace=`paypal_${r}`,d.dataset.partnerAttributionId="GENE_PPCP",d.dataset.pageType=o,a&&(d.dataset.userIdToken=a),d.onload=()=>{const e=new CustomEvent("ppcpScriptLoaded",{detail:r});document.dispatchEvent(e),s()},d.onerror=()=>{e.delete(n),c(new Error(`Failed to load script: ${t}`))},document.head.appendChild(d)}));return e.set(n,c),c}}var s=async t=>{const[s,r,o]=await window.geneCheckout.helpers.loadFromCheckout(["stores.usePaymentStore","stores.useCustomerStore","stores.useCartStore"]),a={"X-Requested-With":"XMLHttpRequest"},{maskedId:n,getMaskedId:c}=o;let d;if(r.customer.tokenType===window.geneCheckout.helpers.getTokenTypes.guestUser)d=n||await c();else{d=(await window.geneCheckout.services.getQuote()).id}try{const s=await window.geneCheckout.services.authenticatedRequest().post(await(async()=>{const t=await window.geneCheckout.helpers.loadFromCheckout(["stores.useCustomerStore"]),{ppcpConfig:s}=e();return`${t.customer.tokenType===window.geneCheckout.helpers.getTokenTypes.guestUser?s.createGuestOrderUrl:s.createOrderUrl}`})(),{cartId:d,method:t},{headers:a});return s.data}catch(e){return s.setPaymentErrorMessage(e.response.data.message),null}};export{s as c,t as l};
